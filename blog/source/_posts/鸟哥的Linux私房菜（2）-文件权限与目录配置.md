---
title: 鸟哥的Linux私房菜（2）--文件权限与目录配置
date: 2019-03-19 15:09:42
tags:
- Linux
- linux
- 文件权限与目录配置
categoties: 拉普拉斯妖
copyright:
---
Linux 和windows的一个主要区别是Windows的设计是单人假多任务，而Linux则是优秀的多人多任务环境，为了针对每个用户都有自己的文件管理权限，Linux有一套自己的文件管理方式，将文件可读写的身份分为三个类别，分别是 *** 拥有者（owner），所属群组（group），其他人（others）。*** 
#### 用户与用户组
开始接触Linux的时候,由于是自己一个用户来操作个人电脑,只对用户的概念有所了解，用户分为`root`用户和普通用户。而用户组的概念则是针对多人多任务的情况提出的，让我们思考这样一个情况，假设两组有竞争关系的小组同时使用一台电脑来完成任务，他们最后需要提交的文件是一样的，那肯定在任务进行期间双方只能改动和查看自己的文件，而不能查看对方组内的文件。*** So，用户组最有用的功能之一，就是当你的团队进行协同工作的时候 。*** 

在假设一种情况，如果你是刚刚的小组中的一员，在进行工作的闲暇之余，你访问了PornHub并且下载了影片，作为一个正常人，你肯定不会想让自己小组的成语直到你干了什么，这时，你可以将文件的权限设置为作为文件拥有者才拥有查看的权利，其他人都没有。那么即时其他人直到这里有一个十分有趣的文件，也无法直到文件的具体内容。

还有一个*** others*** 的概念，在设定好用户组以后，除本组成员外的*** 其他人*** ，你也可以针对他们设置文件的权限。

、linux中默认将所有系统上账户的信息都记录在`/etc/paswd`这个文件内,用户的密码则储存`/etc/shadow`文件中,而用户组名则储存在`/etc/group`中。

#### Linux文件权限概念
##### Linux文件权限设置
由于`chgrp`，`chown`，`chmod`命令都需要root身份来执行，所以我们切换到root账户：
```bash
$ sudo su
```
在根目录`/root`下执行（注意Linux中有很多root，刚刚我们登录的是root账户，这里是根目录，他们都是不同的概念）
```bash
[root@Jason ~]$ ls -al #ls是list的意思，重点显示文件的文件名与相关属性，
                       #选项[-al]表示列出所有的文件详细的权限与属性。
total 220
dr-xr-x---    4     root     root       4096      3月  18 11:51   .
dr-xr-xr-x   24     root     root       4096      3月  20 01:57   ..
drwxrwxrwx    3     root     root       4096      3月  14 11:50   91yunserverspeeder
-rw-r--r--    1     root     root      63298      3月  14 11:50   91yunserverspeeder.tar.gz
-rw-------    1     root     root       2134      3月  18 12:33   .bash_history
-rw-r--r--    1     root     root         18      5月  20 2009   .bash_logout
-rw-r--r--    1     root     root        176      5月  20 2009   .bash_profile
-rw-r--r--    1     root     root        176      9月  23 2004   .bashrc
-rw-r--r--    1     root     root        100      9月  23 2004   .cshrc
-rw-------    1     root     root         40      3月  18 11:52   .lesshst
drwxr-----    3     root     root       4096      10月 16 22:49   .pki
-rwxr-xr-x    1     root     root       6156      3月  14 11:40   serverspeeder.sh
-rw-r--r--    1     root     root      47804      3月  14 11:18   shadowsocks-all.log
-rwxr-xr-x    1     root     root      46219      3月  14 11:13   shadowsocks-all.sh
-rw-r--r--    1     root     root        554      3月  14 11:18   shadowsocks_r_qr.png
-rw-r--r--    1     root     root        129      12月  3 2004    .tcshrc
[    1    ] [ 2  ] [  3   ] [   4   ] [   5    ] [       6      ] [           7                ]
[   权限  ] [链接] [拥有者] [用户组 ] [文件容量] [   修改日期   ] [         文件名             ]
```
（注：为了显示方便，加入了许多空格）
###### [1]代表文件的类型与权限
这一栏有十个字符：
+ 第一个字符代表这个文件是***目录、文件或链接文件等***
 + 当为[d]则是目录，例如上表文件名为[91yunserverspeeder]的一行
 + 当为[-]则是文件，例如上表名为[shadowsocks-all.log]的一行
 + 当为[l]则表示为链接文件（link file）
 + 若是[b]则表示为设备文件里面可供储存的周边设备（可按块随机读写的设备）
 + 若是[c]则表示为设备文件里面的串行端口设备，例如键盘，鼠标（一次性读取设备）；
+ 接下来的字符中，以三个为一组，且均为[rwx]的三个参数的组合，其中[r]代表read，[w]代表write，[x]代表execute，如果该用户拥有该权限，则显示对应的字符，如果没有权限，则显示[-]。
 + 第一组为文件拥有者可具备执行的权限
 + 第二组为加入次用户组之账号的权限
 + 第三组为非本人且没有本用户组的其他账号的权限

###### [2]表示有多少文件名链接到这个节点（inode）
Linux中每个文件都会将它的权限及属性记录到文件系统的inode中，目录树中是使用文件名来记录的，因此每个文件名会关联到一个inode号码，这个数字就是显示有多少个文件关联到同一个inode号码。
###### [3]表示这个文件的拥有者账户
###### [4]表示这个文件的所属用户组
###### [5]表示这个文件的容量，默认为Bytes
###### [6]表示这个文件的创建日期或最后修改日期
###### [7]表示这个文件的文件名

*** Linux下文件权限的设置非常重要！！！ ***

***在修改你的Linux文件与目录的属性之前，一定要先搞清楚，什么数据是可变的，什么是不可变的。***

##### 修改文件属性与权限
```bash
$ chgrp  //修改文件所属用户组
$ chown  //修改文件拥有者
$ chmod  //修改文件的权限，SUID，SGID，SBIT等的特性
```

###### chgrp
```bash
$ chgrp [-R] dirname/filename...
选项与参数：
-R ： 进行递归（recursive）修改，亦即联通子目录下所有文件，目录都更新为这个用户组之意。

```
###### chown
```bash
$ chown [-R] 账号名称 文件或目录
$ chown [-R] 账号名称:用户组名称 文件或目录
选项与参数：
-R ： 进行递归（recursive）修改，亦即联通子目录下所有文件，目录都更新为这个用户组之意。
```
命令中的`:`也可以使用`.`来代替，但是Linux中隐藏文件和用户名及文件名都常常含有`.`，所以我们尽量使用`:`来防止系统误判。
###### chmod
```bash
$ chmod [-R] xyz 文件或目录
选项与参数：
-R ： 进行递归（recursive）修改，亦即联通子目录下所有文件，目录都更新为这个用户组之意。
```
+ 数字类型修改文件权限。
Linux文件的基本权限有九个，分别是拥有者（owner），所属群组（group），其他人（others）三种身份分别拥有读（read），写（write），执行（execute）权限，我们可以使用数字代替各个权限：
```
r：4
w：2
x：1
```
每种身份的权限可以表示为一个数字，这样三组权限有三个数字就可以完全表示了，如：
```
rwx 4+2+1=7
r-x 4+1=5
```
这里鸟哥没有提到，但是我认为也可以理解为也可以理解为二进制形式：
```
rwx 111 = 7
r-x 101 = 5
```
所以我们设置权限时，就可以直接通过这样的方式进行修改
```bash
root@Jason:~# chmod -R xyz 文件或目录
```
+ 符号类型修改权限。我们借用u，g，o来代表三种身份，rwx代表权限

|chmod|u(user) g(group) o(others) a(all)|+ (加入) - (移除) =(设置)|r(读) w(写) x(执行)|文件和目录|
| :|

##### 目录与文件的权限意义
+ 文件

[r]这个权限比较通俗，就是读取文件的内容。

[w]权限可以拥有修改，编辑，写入，新增的权限，但是无权***删除***该文件。

Windows下文件是否具有执行能力是看文件的扩展名来决定，***而在Linux下一个文件是否能够执行即借由[x]这个权限来决定，跟文件名没有绝对的关系。***

+ 目录

[r]权限可以赋予你读取一个目录的权限，可以通过`ls`命令将该目录下的文件列表显示。

[w]的权限对于目录来说十分大，***拥有改变目录结构列表的权限***：即
+ 
  + 建立新文件与新目录
  + 删除已经存在的文件和目录
  + 将文件和目录更名
  + 移动该目录内的文件，目录位置 

[x]代表用户是否有权利进入该目录成为工作目录，能不能进入一个目录只与[x权限有关，***如果你在某目录下不具有x的权限，你就无法切换到该目录下，即使你具有rhuow的权限，也无法执行该目录下的任何命令。*** （所以我们在搭建博客时至少应该开放r和x权限，而w权限不能随意开放）